<?php
header("Content-Type: application/xml; charset=utf-8");

require_once "php/db.php";

$baseUrl = "https://olcreativestudio.fr/";

// Pages statiques
$staticPages = [
    "",
    "index.php",
    "services.php",
    "portfolio.php",
    "contact.php"
];

// Récupération dynamique des projets
$sql = "SELECT id, updated_at FROM portfolio ORDER BY id DESC";
$stmt = $pdo->query($sql);
$projects = $stmt->fetchAll(PDO::FETCH_ASSOC);

// Début du XML
echo '<?xml version="1.0" encoding="UTF-8"?>';
?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">

    <!-- Pages principales -->
    <?php foreach ($staticPages as $page): ?>
    <url>
        <loc><?= $baseUrl . $page ?></loc>
        <changefreq>monthly</changefreq>
        <priority>0.8</priority>
    </url>
    <?php endforeach; ?>

    <!-- Pages portfolio dynamiques -->
    <?php foreach ($projects as $p): ?>
    <url>
        <loc><?= $baseUrl . "portfolio-details.php?id=" . $p['id'] ?></loc>
        <lastmod><?= date("Y-m-d", strtotime($p['updated_at'])) ?></last_]()
